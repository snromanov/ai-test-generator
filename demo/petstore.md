
# Требования к API Swagger Petstore (Demo)

## REQ-001: Добавление нового питомца в магазин (POST /pet)
Система должна позволять добавлять нового питомца в магазин через HTTP POST запрос. Входные данные передаются в формате JSON и включают следующие поля: id (integer, int64) - уникальный идентификатор питомца, должен быть больше нуля; name (string, обязательное) - имя питомца длиной от 2 до 50 символов, только буквы латиницы и кириллицы, допускается дефис; category (object) - категория питомца с полями id и name; photoUrls (array of strings, обязательное) - список URL фотографий, минимум 1 URL; tags (array of objects) - теги для категоризации; status (string) - статус питомца в магазине с допустимыми значениями: available, pending, sold. Бизнес-правила: если питомец с таким id уже существует, API должно возвращать ошибку 409 Conflict; поле name не может содержать цифры или спецсимволы кроме дефиса; если статус не указан, по умолчанию устанавливается available; валидация должна проверять корректность URL в photoUrls; при успешном создании возвращается 201 Created с данными созданного питомца.

## REQ-002: Получение информации о питомце по идентификатору (GET /pet/{petId})
API должно возвращать полную информацию о конкретном питомце по его уникальному идентификатору через HTTP GET запрос. Параметр petId передается в пути URL и должен быть положительным целым числом. Ожидаемое поведение: при успешном нахождении питомца возвращается 200 OK с JSON объектом, содержащим все данные питомца (id, name, category, photoUrls, tags, status); если petId не является числом или меньше либо равен нулю, возвращается 400 Bad Request с описанием ошибки валидации; если питомец с указанным ID не существует в базе данных, возвращается 404 Not Found; метод должен быть идемпотентным и не изменять состояние системы; время ответа не должно превышать 500 миллисекунд; API должно корректно обрабатывать различные некорректные форматы входного параметра.

## REQ-003: Поиск питомцев по статусу (GET /pet/findByStatus)
Эндпоинт должен возвращать список всех питомцев, соответствующих указанному статусу или нескольким статусам. Параметр status передается как query parameter и может содержать одно или несколько значений через запятую (например, available,pending). Допустимые значения статуса: available (питомец доступен для продажи), pending (питомец зарезервирован), sold (питомец продан). Бизнес-правила и валидация: если передан некорректный статус, не входящий в список допустимых значений, API должно возвращать 400 Bad Request с детальным описанием ошибки; если питомцы с указанным статусом не найдены, возвращается пустой массив [] с кодом 200 OK; результаты должны быть отсортированы по дате добавления (от новых к старым); максимальное количество возвращаемых записей за один запрос - 100 единиц; поддержка пагинации через параметры offset и limit; время выполнения запроса не должно превышать 1 секунду даже при большой базе питомцев.

## REQ-004: Обновление информации о существующем питомце (PUT /pet)
Система должна предоставлять возможность полного обновления данных существующего питомца через HTTP PUT запрос. Формат входных данных идентичен формату создания питомца и должен включать все обязательные поля. Поле id является обязательным и используется для идентификации обновляемого питомца. Бизнес-правила: если питомец с указанным id не существует, возвращается 404 Not Found; все валидации, применяемые при создании питомца, должны применяться и при обновлении; частичное обновление (PATCH) не поддерживается данным эндпоинтом; при успешном обновлении возвращается 200 OK с обновленными данными питомца; если попытка обновить питомца в статусе sold на статус available, должна возвращаться ошибка 409 Conflict с сообщением о невозможности операции; история изменений должна логироваться в системе аудита.

## REQ-005: Размещение заказа на покупку питомца (POST /store/order)
API должно позволять пользователям размещать заказы на покупку питомцев через эндпоинт POST /store/order. Входные данные включают: id (integer) - идентификатор заказа; petId (integer, обязательное) - идентификатор питомца для покупки; quantity (integer, обязательное) - количество единиц от 1 до 100; shipDate (string, date-time) - планируемая дата доставки в формате ISO 8601; status (string) - статус заказа со значениями placed, approved, delivered; complete (boolean) - флаг завершенности заказа. Бизнес-правила и ограничения: заказ можно оформить только на питомца в статусе available, иначе возвращается 400 Bad Request; если quantity меньше 1 или больше 100, возвращается ошибка 400 Bad Request с описанием нарушенного ограничения; система должна атомарно проверить доступность питомца и создать заказ, изменив статус питомца на pending; если petId не существует, возвращается 404 Not Found; при успешном создании заказа возвращается 201 Created с полными данными созданного заказа; дата shipDate не может быть в прошлом; максимальное время обработки запроса - 2 секунды.

## REQ-006: Получение информации о заказе по идентификатору (GET /store/order/{orderId})
Эндпоинт должен возвращать полную информацию о заказе по его уникальному идентификатору. Параметр orderId (integer) передается в пути URL и должен быть положительным числом в диапазоне от 1 до 10 включительно (ограничение демо-версии). Ожидаемое поведение: при успешном нахождении заказа возвращается 200 OK с JSON объектом заказа; если orderId не является числом, меньше 1 или больше 10, возвращается 400 Bad Request; если заказ не найден, возвращается 404 Not Found; метод должен быть идемпотентным; в ответе должны присутствовать все поля заказа включая статус и дату создания; время ответа не должно превышать 500 миллисекунд; API должно корректно обрабатывать граничные значения orderId.

## REQ-007: Удаление заказа из системы (DELETE /store/order/{orderId})
API должно предоставлять возможность удаления заказа по его идентификатору через HTTP DELETE запрос. Параметр orderId должен быть положительным целым числом. Бизнес-правила: можно удалить только заказы в статусе placed или approved; заказы в статусе delivered не могут быть удалены и должны возвращать 400 Bad Request с соответствующим сообщением; при успешном удалении возвращается 204 No Content без тела ответа; если заказ не найден, возвращается 404 Not Found; операция удаления должна быть идемпотентной - повторный DELETE на уже удаленный заказ возвращает 404; при удалении заказа статус связанного питомца должен автоматически вернуться в available если заказ был в статусе placed или approved; транзакция должна быть атомарной; должна вестись аудит-логирование всех операций удаления.

## REQ-008: Создание нового пользователя в системе (POST /user)
Система должна позволять создавать новых пользователей через эндпоинт POST /user. Входные данные в формате JSON включают: id (integer) - уникальный идентификатор; username (string, обязательное) - имя пользователя длиной от 4 до 20 символов, только буквы латиницы, цифры и подчеркивание; firstName (string) - имя; lastName (string) - фамилия; email (string, обязательное) - email адрес в валидном формате; password (string, обязательное) - пароль минимум 8 символов, должен содержать минимум одну заглавную букву, одну строчную и одну цифру; phone (string) - номер телефона; userStatus (integer) - статус пользователя. Бизнес-правила: username должен быть уникальным в системе, при дубликате возвращается 409 Conflict; email также должен быть уникальным; пароль должен хэшироваться перед сохранением с использованием bcrypt или аналогичного алгоритма; при успешном создании возвращается 201 Created; в ответе не должен передаваться пароль пользователя; валидация email должна проверять корректность формата; username не должен содержать запрещенные слова.
