@startuml
title AI Test Generator - UML (Component)
hide stereotypes

package "Entry Points" {
  [main.py] as CLI
  [generate_tests.py] as GT
  [Makefile] as MK
}

package "Pipelines" {
  [PipelineOrchestrator] as PO
}

package "Parsers" {
  [StructuredRequirementParser] as SRP
  [ConfluenceParser] as CP
}

package "Generators" {
  [TestCaseGenerator] as TCG
  [Exporters (Excel/CSV)] as EXP
}

package "Prompts" {
  [qa_prompts.py] as QA
  [ui_prompts.py] as UI
  [llm_integration_prompts.py] as LLM
}

package "State" {
  [StateManager] as SM
  database ".test_generator_state.json" as STATE
  file ".ai-test-gen-signature-key" as SIG
}

package "Utils" {
  [TestGeneratorHelper] as TGH
  [RequirementAnalyzer] as RA
  [Cleanup] as CLN
  [ProjectInfo] as PI
  [InputValidation] as IV
  [Logger] as LOG
}

package "Security" {
  [security.py] as SEC
  [ssrf_protection.py] as SSRF
  [rate_limiter.py] as RL
  [state_integrity.py] as SI
  [security_logging.py] as SL
}

package "Models" {
  [test_agent.py] as AM
}

file "artifacts/*.xlsx/.csv" as OUT
cloud "Confluence API" as CONF
actor "CLI Agent" as AGENT

MK ..> GT
GT --> CLI

CLI --> PO
CLI --> SM
CLI --> TCG
CLI --> SRP
CLI --> RA
CLI --> TGH
CLI --> CLN
CLI --> PI
CLI --> IV
CLI --> AM
CLI --> QA
CLI --> UI
CLI --> LLM

PO --> CLN
PO --> SM
PO --> TGH
PO --> RA
PO --> TCG
PO --> EXP
PO --> SRP
PO --> IV
PO --> LOG

TCG --> CP
TCG --> SM
TCG --> EXP
TCG --> IV
TCG --> LOG

TGH --> SM
TGH --> LOG
RA --> TGH
RA --> LOG
SRP --> LOG

CP --> SSRF
CP --> RL
CP --> CONF
CP --> SL
CP --> LOG

SM --> SEC
SM --> SI
SM --> IV
SM --> STATE
SM --> SIG
SM --> SL
SM --> LOG

EXP --> OUT
EXP --> AM
EXP --> LOG

QA --> PI
SEC --> SL
SSRF --> SL
RL --> SL
SI --> SL
IV --> LOG
CLN --> LOG
PI --> LOG
AM --> LOG

AGENT ..> QA
AGENT ..> TGH
@enduml
